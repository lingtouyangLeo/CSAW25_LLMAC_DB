This is your new CTF question"{
"name": "obligatory-rsa",
"description": "Crypto just wouldn't be crypto without one!",
"author": "",
"category": "crypto",
"flag": "csawctf{wH04m1_70d3Ny_7r4D1710n_4820391578649021735}",
"files": [
"README.md"
]
}
" # Echoes of DES-tiny

Description
Crypto just wouldn't be crypto without one!

n1 = 129092526753383933030272290277107300767707654330551632967994396398045326531320303963182497488182474202461120692162734880438261410066549845639992024037416720228421076282632904598519793243067220342037144864237020757818263128301138206081187472003821789897063195512919097350247829148288118913456964033001399074373

n2 = 108355113470836594630192960651980673780103497896732213011958303033575870030505528169174729530490405910634291415346360688290452976527316909469646908289732023715737439312572012648165819533234604850608390233938174081867146846639110685928136323983961395098632140681799175543046722931901766226759894951292033805879

d1 = 88843495989869871001559754882918076779858404440780391818567639602073173623287821751315349650577023725245222074965050035045516207303078461168168819365025746973589245131570143944718203046457391270418459087764266630890566079039821735168805805866019315142070438225092171304343352469029480503113942986147848666077

d2 = 94565144275929764017241865812435668644218918537941567711225644474418458115544003036362558987818610553975855551983688286593672386482543188020042082319191545660551324293738920214028045344249670512999137548994496577128446165632885775744795722253354007167294035878656056258332703809173397147948143695113558988035

e = 65537

Difficulty
beginner: understanding of rsa common factors attack

Time Spent
No more than 30 minutes

Tools
pycryptodome
rsactftool
Infrastructure
None
Artifacts
None
Fun
So much fun!!!! Think it's a good idea to fit an easy crypto in here for more beginners, also to pad our list of challenges :))
#!/usr/bin/env python3

from Crypto.Util.number import bytes_to_long, long_to_bytes
from math import gcd

parameters
n1 = 129092526753383933030272290277107300767707654330551632967994396398045326531320303963182497488182474202461120692162734880438261410066549845639992024037416720228421076282632904598519793243067220342037144864237020757818263128301138206081187472003821789897063195512919097350247829148288118913456964033001399074373
n2 = 108355113470836594630192960651980673780103497896732213011958303033575870030505528169174729530490405910634291415346360688290452976527316909469646908289732023715737439312572012648165819533234604850608390233938174081867146846639110685928136323983961395098632140681799175543046722931901766226759894951292033805879
e = 65537

encrypt flag
pt = b"csawctf{wH04m1_70d3Ny_7r4D1710n_4820391578649021735}"
pt_int = bytes_to_long(pt)
ct1 = pow(pt_int, e, n1)
ct2 = pow(pt_int, e, n2)
print("\n=== Provided Values ===")
print(f"n1 = {n1}")
print(f"n2 = {n2}")
print(f"e = {e}")
print()
print(f"ct1 = {ct1}")
print(f"ct2 = {ct2}")
ct1 = 88843495989869871001559754882918076779858404440780391818567639602073173623287821751315349650577023725245222074965050035045516207303078461168168819365025746973589245131570143944718203046457391270418459087764266630890566079039821735168805805866019315142070438225092171304343352469029480503113942986147848666077
ct2 = 94565144275929764017241865812435668644218918537941567711225644474418458115544003036362558987818610553975855551983688286593672386482543188020042082319191545660551324293738920214028045344249670512999137548994496577128446165632885775744795722253354007167294035878656056258332703809173397147948143695113558988035

decrypt the flag
print("\n=== Solver Check ===")
shared_p = gcd(n1, n2)
print(f"shared_p = {shared_p}")
print(f"q1 = {n1 // shared_p}")
print(f"q2 = {n2 // shared_p}")

phi1 = (shared_p - 1) * (n1 // shared_p - 1)
d1 = pow(e, -1, phi1)
m_recovered = pow(ct1, d1, n1)
print("Recovered:", long_to_bytes(m_recovered))

I'll analyze this RSA challenge and run the solve script to verify it works correctly.

This is a classic RSA common factor attack challenge where two moduli n1 and n2 share a common prime factor. Let me run the solve script to see if it successfully recovers the flag.

Perfect! The solve script works correctly and recovers the flag: csawctf{wH04m1_70d3Ny_7r4D1710n_4820391578649021735}

Summary
This is a beginner-friendly RSA challenge that demonstrates the common factor attack:

Vulnerability: Two RSA moduli (n1 and n2) share a common prime factor p.

Attack Method:

Find the shared prime: p = gcd(n1, n2)
Calculate the other primes: q1 = n1 / p and q2 = n2 / p
Compute φ(n1) = (p - 1) × (q1 - 1)
Calculate private exponent: d1 = e^(-1) mod φ(n1)
Decrypt the ciphertext: m = ct1^d1 mod n1
The script successfully:

Identifies the shared prime factor using GCD
Derives the private key components
Decrypts the flag from ciphertext
This is indeed a classic beginner crypto challenge that teaches an important lesson: never reuse prime factors across different RSA keypairs!